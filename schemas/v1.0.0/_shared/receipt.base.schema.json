{
  "$id": "https://commandlayer.org/schemas/v1.0.0/_shared/receipt.base.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "receipt.base",
  "description": "Base structure for all CommandLayer receipts, extended on a per-verb basis. Designed for A2A, Swarm-style delegation, and x402 alignment.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "x402": {
      "description": "x402 envelope describing the verb and version for this receipt.",
      "allOf": [
        { "$ref": "https://commandlayer.org/schemas/v1.0.0/_shared/x402.schema.json" }
      ]
    },

    "trace": {
      "description": "Shared trace envelope for correlating requests and receipts across agents, hops, and spans.",
      "allOf": [
        { "$ref": "https://commandlayer.org/schemas/v1.0.0/_shared/trace.schema.json" }
      ]
    },

    "timing": {
      "description": "Optional execution timing metadata for this receipt.",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "started_at": {
          "description": "RFC 3339 timestamp when execution started.",
          "type": "string",
          "format": "date-time",
          "maxLength": 64
        },
        "completed_at": {
          "description": "RFC 3339 timestamp when execution completed.",
          "type": "string",
          "format": "date-time",
          "maxLength": 64
        },
        "duration_ms": {
          "description": "Observed execution duration in milliseconds.",
          "type": "integer",
          "minimum": 0,
          "maximum": 86400000
        }
      }
    }

    // keep your existing: status, error, delegation_result, metadata, result, usage, etc.
  },
  "required": ["x402", "trace", "status"]
}
